(this["webpackJsonpreact-project"]=this["webpackJsonpreact-project"]||[]).push([[0],{13:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n.n(c),i=n(7),r=n.n(i),a=(n(13),n(3)),o=n(2),l=n(0);function d(){return Object(l.jsx)("footer",{className:"bg-dark text-white p-3 mt-3 text-center",children:Object(l.jsx)("small",{children:"\xa9 Copyright 2021 - All rights reserved."})})}var j=function(e,t){return"http://192.168.56.99/HU_JS-PHP_A/api/v1/".concat(e).concat(t?"?token=".concat(t):"")},u=function(e,t){return fetch(j(e,t)).then((function(e){return e.json()}))},b=function(e,t,n){return fetch(j(e,t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(e){return e.json()}))};function h(e){var t=e.goToScreen,n=e.logout,c=e.user,s=e.isLoggedIn;return Object(l.jsx)("header",{className:"sticky-top shadow-sm",children:Object(l.jsx)("nav",{className:"navbar navbar-light bg-light",children:Object(l.jsxs)("div",{className:"container-fluid d-flex justify-content-between align-items-center",children:[Object(l.jsx)("div",{onClick:function(){return t("/")},role:"button",children:Object(l.jsx)("h1",{className:"navbar-brand m-0",children:"Event Booking Platform"})}),!s&&Object(l.jsx)("div",{children:Object(l.jsx)("button",{className:"btn btn-outline-secondary login-btn",onClick:function(){return t("/login")},children:"Login"})}),s&&Object(l.jsxs)("div",{className:"d-flex justify-content-center align-items-center",children:[Object(l.jsx)("span",{className:"mr-3",children:c.username}),Object(l.jsx)("button",{className:"btn btn-outline-secondary text-dark logout-btn",onClick:function(){b("logout",c.token).then((function(){return n()}))},children:"Logout"})]})]})})})}function m(e){var t=e.children;return Object(l.jsx)("main",{className:"flex-fill mt-5 container",children:t})}function O(e){var t=e.event,n=e.selectSession,c=e.isLoggedIn,s=e.selectedIds;return Object(l.jsxs)("div",{children:[Object(l.jsxs)("div",{className:"row no-gutters clock",children:[Object(l.jsx)("div",{className:"col-4"}),Object(l.jsx)("div",{className:"col-2",children:"9:00"}),Object(l.jsx)("div",{className:"col-2",children:"11:00"}),Object(l.jsx)("div",{className:"col-2",children:"13:00"}),Object(l.jsx)("div",{className:"col-2",children:"15:00"})]}),t.channels.map((function(e){return Object(l.jsxs)("div",{className:"row border no-gutters",children:[Object(l.jsx)("div",{className:"col-2 border-right p-2 channel",children:e.name}),Object(l.jsx)("div",{className:"col-10",children:e.rooms.map((function(e){return Object(l.jsxs)("div",{className:"row no-gutters",children:[Object(l.jsx)("div",{className:"col-2 border-right p-2 room",children:e.name}),Object(l.jsx)("div",{className:"col-10 d-flex",children:e.sessions.map((function(e){var t=c&&("talk"===e.type||s.includes(e.id));return Object(l.jsx)("div",{className:"p-2 m-1 agenda-item session ".concat(t?"registered":""),onClick:function(){return n(e.id)},role:"button",children:e.title},e.id)}))})]},e.id)}))})]},e.id)}))]})}function f(e){var t=e.goToScreen,n=e.isLoggedIn,s=e.user,i=Object(c.useState)(),r=Object(o.a)(i,2),a=r[0],d=r[1],j=Object(c.useState)([]),b=Object(o.a)(j,2),h=b[0],m=b[1],f=Object(c.useMemo)((function(){var e,t=h.find((function(e){return e.event.id===(null===a||void 0===a?void 0:a.id)}));return null!==(e=null===t||void 0===t?void 0:t.session_ids)&&void 0!==e?e:[]}),[a,h]);return Object(c.useEffect)((function(){n&&u("registrations",s.token).then((function(e){e.message?alert(e.message):m(e.registrations)}))}),[n,s]),Object(c.useEffect)((function(){var e=window.location.pathname.split("/"),t=e[e.length-2],n=e[e.length-1];u("organizers/".concat(t,"/events/").concat(n)).then((function(e){e.message?alert(e.message):d(e)}))}),[]),a?Object(l.jsxs)("div",{children:[Object(l.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(l.jsx)("h2",{children:a.name}),Object(l.jsx)("button",{className:"btn btn-outline-secondary",id:"register",onClick:function(){var e=window.location.pathname.split("/"),c=e[e.length-2],s=e[e.length-1];t(n?"/register/".concat(c,"/").concat(s):"/login")},children:"Register for this event"})]}),Object(l.jsx)("div",{className:"mt-3",children:Object(l.jsx)(O,{event:a,selectSession:function(e){var n=window.location.pathname.split("/"),c=n[n.length-2],s=n[n.length-1];t("/session/".concat(c,"/").concat(s,"/").concat(e))},isLoggedIn:n,selectedIds:f})})]}):Object(l.jsx)(l.Fragment,{})}function g(e){var t=e.event,n=e.goToScreen;return Object(l.jsxs)("div",{className:"border p-3 mb-4 bg-light card-hover event",onClick:function(){return n("/event/".concat(t.organizer.slug,"/").concat(t.slug))},role:"button",children:[Object(l.jsx)("h2",{className:"m-0 mb-2",children:t.name}),Object(l.jsxs)("p",{className:"m-0",children:[t.organizer.name,", ",t.date]})]})}function v(e){var t=e.goToScreen,n=Object(c.useState)([]),s=Object(o.a)(n,2),i=s[0],r=s[1];return Object(c.useEffect)((function(){u("events").then((function(e){var t=e.events;return r(t)}))}),[]),Object(l.jsx)("div",{children:i.map((function(e){return Object(l.jsx)(g,{event:e,goToScreen:t},e.id)}))})}function x(e){var t=e.login,n=Object(c.useState)(""),s=Object(o.a)(n,2),i=s[0],r=s[1],a=Object(c.useState)(""),d=Object(o.a)(a,2),j=d[0],u=d[1],h=Object(c.useState)(""),m=Object(o.a)(h,2),O=m[0],f=m[1];return Object(l.jsxs)("div",{children:[Object(l.jsx)("h2",{className:"mb-3",children:"Login"}),O&&Object(l.jsx)("div",{className:"alert alert-danger my-4",role:"alert",children:O}),Object(l.jsxs)("form",{onSubmit:function(e){e.preventDefault(),e.stopPropagation(),b("login","",{lastname:i,registration_code:j}).then((function(e){e.message?f("Lastname or registration code not correct"):(r(""),u(""),f(""),t(e),Promise.resolve().then((function(){return window.history.back()})))}))},children:[Object(l.jsxs)("div",{className:"form-group",children:[Object(l.jsx)("label",{htmlFor:"lastname",children:"Lastname"}),Object(l.jsx)("input",{type:"text",className:"form-control",id:"lastname",placeholder:"Lastname",value:i,onChange:function(e){return r(e.target.value)}})]}),Object(l.jsxs)("div",{className:"form-group",children:[Object(l.jsx)("label",{htmlFor:"registration_code",children:"Registration Code"}),Object(l.jsx)("input",{type:"text",className:"form-control",id:"registration_code",placeholder:"Code",value:j,onChange:function(e){return u(e.target.value)}})]}),Object(l.jsx)("button",{type:"submit",className:"btn btn-secondary",id:"login",children:"Login"})]})]})}var p=n(8);function N(e){var t=e.ticket,n=e.selectedTicket,s=e.setSelectedTicket,i=Object(c.useMemo)((function(){return t.available?t.description:"unavailable"}),[t]),r=function(){t.available&&s(t)},a=t.available?"card-hover bg-white cursor-pointer":"bg-light disabled";return Object(l.jsxs)("div",{className:"p-3 border ticket row no-gutters d-flex align-items-center mx-2 ".concat(a),onClick:r,children:[Object(l.jsx)("div",{className:"col-auto mr-3",children:Object(l.jsx)("input",{type:"radio",name:"ticket",checked:n===t,onChange:r,id:"ticket".concat(t.id)})}),Object(l.jsxs)("label",{className:"col d-flex flex-column justify-content-center mb-0",htmlFor:"ticket".concat(t.id),children:[Object(l.jsxs)("h3",{className:"h4 m-0",children:[t.name," ",t.cost,".-"]}),i&&Object(l.jsx)("p",{className:"m-0 mt-2",children:i})]})]})}function w(e){var t=e.user,n=e.goToScreen,s=Object(c.useState)(),i=Object(o.a)(s,2),r=i[0],a=i[1],d=Object(c.useState)(),j=Object(o.a)(d,2),h=j[0],m=j[1],O=Object(c.useState)([]),f=Object(o.a)(O,2),g=f[0],v=f[1],x=Object(c.useMemo)((function(){if(!r)return[];var e=[];return r.channels.forEach((function(t){return t.rooms.forEach((function(t){return t.sessions.filter((function(e){return"workshop"===e.type})).forEach((function(t){return e.push(t)}))}))})),e}),[r]),w=h?h.cost:0,k=Object(c.useMemo)((function(){return g.reduce((function(e,t){return e+t.cost}),0)}),[g]);Object(c.useEffect)((function(){var e=window.location.pathname.split("/"),t=e[e.length-2],n=e[e.length-1];u("organizers/".concat(t,"/events/").concat(n)).then((function(e){e.message?alert(e.message):a(e)}))}),[]);return r?Object(l.jsxs)("div",{children:[Object(l.jsx)("div",{className:"d-flex justify-content-between align-items-center",children:Object(l.jsx)("h2",{children:r.name})}),Object(l.jsx)("div",{className:"mt-3",children:Object(l.jsx)("div",{className:"row no-gutters",children:r.tickets.map((function(e){return Object(l.jsx)("div",{className:"col-4",children:Object(l.jsx)(N,{ticket:e,selectedTicket:h,setSelectedTicket:m})},e.id)}))})}),Object(l.jsxs)("div",{className:"mt-5",children:[Object(l.jsx)("h3",{className:"h5 mb-3 font-weight-bold",children:"Select additional workshops you want to book"}),x.map((function(e){return Object(l.jsxs)("div",{className:"form-check",children:[Object(l.jsx)("input",{className:"form-check-input workshop",type:"checkbox",value:e.id,id:"ws".concat(e.id),checked:g.map((function(e){return e.id})).includes(e.id),onChange:function(t){return function(e,t){e.target.checked?v([].concat(Object(p.a)(g),[t])):v(g.filter((function(e){return e.id!==t.id})))}(t,e)}}),Object(l.jsx)("label",{className:"form-check-label",htmlFor:"ws".concat(e.id),children:e.title})]},e.id)}))]}),Object(l.jsxs)("div",{className:"mt-5 row",children:[Object(l.jsx)("div",{className:"col-8"}),Object(l.jsxs)("div",{className:"col-4",children:[Object(l.jsx)("h3",{className:"h5 mb-3 font-weight-bold",children:"Checkout"}),Object(l.jsxs)("div",{className:"row",children:[Object(l.jsx)("div",{className:"col-9",children:"Event ticket"}),Object(l.jsxs)("div",{className:"col-3",id:"event-cost",children:[w,".-"]})]}),Object(l.jsxs)("div",{className:"row",children:[Object(l.jsx)("div",{className:"col-9",children:"Additional workshops"}),Object(l.jsxs)("div",{className:"col-3",id:"additional-cost",children:[k,".-"]})]}),Object(l.jsxs)("div",{className:"row border-top",children:[Object(l.jsx)("div",{className:"col-9",children:"Total"}),Object(l.jsxs)("div",{className:"col-3",id:"total-cost",children:[w+k,".-"]})]}),Object(l.jsx)("button",{className:"btn btn-lg btn-outline-secondary mt-5",id:"purchase",onClick:function(){return function(){var e=h.id,c=g.map((function(e){return e.id})),s=window.location.pathname.split("/"),i=s[s.length-2],r=s[s.length-1];b("organizers/".concat(i,"/events/").concat(r,"/registration"),t.token,{ticket_id:e,session_ids:c}).then((function(e){e.message&&"Registration successful"===e.message?n("/event/".concat(i,"/").concat(r)):alert(e.message)}))}()},disabled:!w,children:"Purchase"})]})]})]}):Object(l.jsx)(l.Fragment,{})}function k(){var e=Object(c.useState)(),t=Object(o.a)(e,2),n=t[0],s=t[1],i=Object(c.useState)(),r=Object(o.a)(i,2),a=r[0],d=r[1];return Object(c.useEffect)((function(){var e=window.location.pathname.split("/"),t=e[e.length-3],n=e[e.length-2],c=parseInt(e[e.length-1],10);u("organizers/".concat(t,"/events/").concat(n)).then((function(e){var t;e.message?alert(e.message):(e.channels.forEach((function(e){return e.rooms.forEach((function(e){return e.sessions.forEach((function(e){e.id===c&&(t=e)}))}))})),d(t),s(e))}))}),[]),n?a?Object(l.jsxs)("div",{children:[Object(l.jsxs)("h2",{children:[a.title," - ",a.type]}),Object(l.jsx)("p",{children:a.description}),Object(l.jsxs)("div",{className:"row",children:[Object(l.jsx)("div",{className:"col-3 text-brown",children:"Speaker"}),Object(l.jsx)("div",{className:"col-3",children:a.speaker})]}),Object(l.jsxs)("div",{className:"row",children:[Object(l.jsx)("div",{className:"col-3 text-brown",children:"Start"}),Object(l.jsx)("div",{className:"col-3",children:a.start})]}),Object(l.jsxs)("div",{className:"row",children:[Object(l.jsx)("div",{className:"col-3 text-brown",children:"End"}),Object(l.jsx)("div",{className:"col-3",children:a.end})]}),a.cost&&Object(l.jsxs)("div",{className:"row",children:[Object(l.jsx)("div",{className:"col-3 text-brown",children:"Cost"}),Object(l.jsxs)("div",{className:"col-3",children:[a.cost,".-"]})]})]}):Object(l.jsx)("p",{children:"Session not found"}):Object(l.jsx)(l.Fragment,{})}var S=function(){var e=Object(c.useState)(),t=Object(o.a)(e,2),n=t[0],s=t[1],i=Object(c.useState)(),r=Object(o.a)(i,2),j=r[0],u=r[1];Object(c.useEffect)((function(){localStorage.getItem("user")&&u(JSON.parse(localStorage.getItem("user")));var e=function(){var e="http://192.168.56.99/HU_JS-PHP_B".replace(window.location.origin,""),t=window.location.pathname.replace(e,"").split("/");s(t[1])};return e(),window.addEventListener("popstate",e),function(){return window.removeEventListener("popstate",e)}}),[]);var b=function(){u(void 0),localStorage.removeItem("user"),g("/login")},O=Object(c.useMemo)((function(){return!!j}),[j]),g=Object(c.useCallback)((function(e){var t=e.split("/")[1];n!==t&&(s(t),window.history.pushState("","","".concat("http://192.168.56.99/HU_JS-PHP_B").concat(e)))}),[n]),p=Object(c.useMemo)((function(){var e=function(){return Object(l.jsx)(l.Fragment,{})};switch(n){case void 0:return e;case"event":return function(e){return Object(l.jsx)(f,Object(a.a)({},e))};case"session":return function(e){return Object(l.jsx)(k,Object(a.a)({},e))};case"register":return O?function(e){return Object(l.jsx)(w,Object(a.a)({},e))}:(g("/login"),e);case"login":return function(e){return Object(l.jsx)(x,Object(a.a)({},e))}}return function(e){return Object(l.jsx)(v,Object(a.a)({},e))}}),[n,O,g]);return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(h,{goToScreen:g,logout:b,isLoggedIn:O,user:j}),Object(l.jsx)(m,{children:Object(l.jsx)(p,{login:function(e){u(e),localStorage.setItem("user",JSON.stringify(e))},logout:b,isLoggedIn:O,user:j,goToScreen:g})}),Object(l.jsx)(d,{})]})},y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,16)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),c(e),s(e),i(e),r(e)}))};r.a.render(Object(l.jsx)(s.a.StrictMode,{children:Object(l.jsx)(S,{})}),document.getElementById("root")),y()}},[[15,1,2]]]);
//# sourceMappingURL=main.ad550fac.chunk.js.map